<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} - Florian Gertner Kilian</title>

    <!-- SEO & Open Graph -->

    <!-- SEO & Open Graph -->
    {% seo %}
    {% if page.image %}
    <meta property="og:image:alt" content="{{ page.title | escape }}">
    {% if page.width %}
    <meta property="og:image:width" content="{{ page.width }}">{% endif %}
    {% if page.height %}
    <meta property="og:image:height" content="{{ page.height }}">{% endif %}
    {% endif %}

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Inter&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ '/assets/css/boxicons.min.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/tailwind.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/styles.css' | relative_url }}">
    <link rel="icon" type="image/x-icon" href="{{ '/assets/media/favicon.ico' | relative_url }}">

    <link rel="canonical" href="{{ site.url }}{{ page.url }}">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "CreativeWork",
      "headline": "{{ page.title | escape }}",
      "image": [
        "{{ site.url }}{{ page.image }}"
        {% for img in page.gallery %},"{{ site.url }}{{ img }}"{% endfor %}
      ],
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      "author": [{
          "@type": "Person",
          "name": "Florian Gertner Kilian",
          "url": "https://wizyx.me"
        }]
    }
    </script>

    <!-- Breadcrumb JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Accueil",
        "item": "{{ site.url }}"
      },{
        "@type": "ListItem",
        "position": 2,
        "name": "Créations",
        "item": "{{ site.url }}/creations"
      },{
        "@type": "ListItem",
        "position": 3,
        "name": "{{ page.title | escape }}",
        "item": "{{ site.url }}{{ page.url }}"
      }]
    }
    </script>

    <script src="/js/layout.js" defer></script>
    <script src="/js/theme.js" defer></script>
</head>

<body class="dark:bg-[#121212] font-inter text-[#411FEB]">

    <!-- Navbar -->
    {% include navbar.html %}

    <main class="px-6 lg:px-32 mx-auto p-8 space-y-4">
        <div>
            <div class="flex flex-col items-start lg:flex-row lg:items-center">
                <a href="{% if page.is_study %}/creations_studies/{% else %}/creations/{% endif %}"
                    class="inline-flex items-center justify-center text-[#121212] dark:text-white hover:text-[#411FEB] dark:hover:text-[#5536ED] transition-colors p-2 -ml-2 rounded-full hover:bg-black/5 dark:hover:bg-white/5 leading-none"
                    aria-label="Retour aux créations">
                    <i class='bx bx-arrow-back text-2xl lg:text-3xl leading-none'></i>
                </a>
                <h1 class="text-2xl lg:text-4xl font-bold text-[#411FEB] dark:text-[#5536ED] leading-tight">{{
                    page.title }}</h1>
            </div>

            <div class="flex flex-col gap-2 mb-8">
                <div class="flex flex-wrap items-center gap-2 text-sm text-[#121212] dark:text-white">
                    <div class="flex items-center gap-1">
                        <i class="bx bxs-calendar-alt text-[#411FEB] dark:text-[#5536ED] opacity-[0.48] text-base"></i>
                        {% assign months =
                        "janvier,février,mars,avril,mai,juin,juillet,août,septembre,octobre,novembre,décembre" | split:
                        "," %}
                        {% assign m = page.date | date: "%-m" | minus: 1 %}
                        <time datetime="{{ page.date | date_to_xmlschema }}">{{ months[m] }} {{ page.date | date: "%Y"
                            }}</time>
                    </div>

                    {% if page.type %}
                    <span class="text-[#411FEB] dark:text-[#5536ED] opacity-[0.48]">&middot;</span>
                    <span>{{ page.type }}</span>
                    {% endif %}

                    {% if page.context %}
                    <span class="text-[#411FEB] dark:text-[#5536ED] opacity-[0.48]">&middot;</span>
                    <span>{{ page.context }}</span>
                    {% endif %}
                </div>

                <div class="flex flex-wrap gap-2">
                    {% for tag in page.tags %}
                    <span
                        class="inline-flex items-center gap-1 px-2 rounded-full border border-[#411FEB] text-[#411FEB] font-semibold text-sm dark:text-[#5536ED] dark:border-[#5536ED]"
                        style="background-color: rgba(65, 31, 235, 0.12)">
                        <i class='{{ tag.icon }} text-base'></i> {{ tag.name }}
                    </span>
                    {% endfor %}
                </div>
            </div>
        </div>

        <article class="flex flex-col lg:flex-row gap-8">
            <!-- Project Content -->
            <div class="lg:w-1/2 space-y-4 order-2 lg:order-1">
                <div class="prose dark:prose-invert max-w-none text-[#121212] dark:text-white leading-relaxed">
                    {{ content }}
                </div>

                {% if page.technologies %}
                <div class="mt-6 mb-8">
                    <h3 class="text-lg font-bold text-[#121212] dark:text-white mb-3">Outils utilisés</h3>
                    <div class="flex flex-wrap gap-2">
                        {% for tech in page.technologies %}
                        <span
                            class="inline-flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm font-medium text-gray-700 dark:text-[#5536ED]">
                            {% if tech.icon %}
                            <i class="{{ tech.icon }}"></i>
                            {% endif %}
                            {{ tech.name }}
                        </span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                {% if page.testimonial %}
                <div class="mt-6 mb-8">
                    <div
                        class="bg-[#E8E4FC] dark:bg-[#5536ED] dark:bg-opacity-[0.10] border border-2 border-[#C1B4F8] dark:border-[#281E5A] text-[#411FEB] dark:text-[#5536ED] text-left p-6 rounded-2xl shadow-lg flex flex-col gap-3">
                        <!-- Guillemets -->
                        <div class="text-4xl font-bold text-[#411FEB] dark:text-[#5536ED]">
                            <i class='bx bxs-quote-left'></i>
                        </div>
                        <!-- Texte du témoignage -->
                        <p class="text-base dark:text-white leading-relaxed">
                            {{ page.testimonial.text }}
                        </p>
                        <!-- Auteur -->
                        <div class="flex items-center gap-3 mt-auto">
                            <img src="{{ page.testimonial.author.avatar }}" alt="{{ page.testimonial.author.name }}"
                                class="w-12 h-12 rounded-full object-cover" width="48" height="48" loading="lazy"
                                decoding="async">
                            <div>
                                <h4 class="font-bold text-[#411FEB] dark:text-[#5536ED]">{{ page.testimonial.author.name
                                    }}</h4>
                                <p class="font-light text-sm text-[#411FEB] dark:text-[#5536ED]">
                                    {% if page.testimonial.author.companyUrl %}
                                    <a href="{{ page.testimonial.author.companyUrl }}" target="_blank"
                                        rel="noopener noreferrer">{{ page.testimonial.author.title }}</a>
                                    {% else %}
                                    {{ page.testimonial.author.title }}
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                {% if page.projectLink and page.projectLink != "#" %}
                <a href="{{ page.projectLink }}" target="_blank"
                    class="flex items-center justify-center gap-2 bg-[#411FEB] text-white font-semibold px-6 py-3 rounded-lg hover:bg-[#3A1CC5] transition w-full lg:w-auto lg:self-start">
                    {% if page.type == 'Application' %}
                    <i class="bx bx-globe"></i> Voir l'application
                    {% else %}
                    <i class="bx bx-globe"></i> Visiter le site web
                    {% endif %}
                </a>
                {% endif %}

                <hr class="my-6 border-gray-200 dark:border-white/10">
                <a href="/services/"
                    class="group flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-white/5 -mx-4 px-4 py-2 transition-colors cursor-pointer">

                    <div class="flex flex-shrink-0 mr-2">
                        <img src="/assets/media/profilepicturepro.png" alt="Florian Gertner Kilian"
                            class="w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover border-2 border-white dark:border-[#121212] group-hover:border-[#411FEB] transition-colors relative z-30">
                        {% if page.collaborators %}
                        {% for collaborator in page.collaborators %}
                        <img src="{{ collaborator.avatar }}" alt="{{ collaborator.name }}"
                            class="w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover border-2 border-white dark:border-[#121212] group-hover:border-[#411FEB] transition-colors relative"
                            style="z-index: {{ 20 | minus: forloop.index }}; margin-left: -1rem;">
                        {% endfor %}
                        {% endif %}
                    </div>

                    <div>
                        <p
                            class="text-sm font-semibold text-[#121212] dark:text-white group-hover:text-[#411FEB] transition-colors">
                            {% assign collaborator_count = page.collaborators | size %}
                            {% if collaborator_count == 0 %}
                            Designé par Florian Gertner Kilian
                            {% elsif collaborator_count == 1 %}
                            Designé par Florian Gertner Kilian et {{ page.collaborators[0].name }}
                            {% else %}
                            Designé par Florian Gertner Kilian + {{ collaborator_count }} autres personnes
                            {% endif %}
                        </p>
                        <p
                            class="text-xs text-gray-500 dark:text-gray-400 group-hover:text-[#411FEB] transition-colors">
                            Besoin d'un design pour votre projet ? <span
                                class="underline decoration-[#411FEB]/30 group-hover:decoration-[#411FEB]">Voir mes
                                services</span></p>
                    </div>
                </a>
            </div>

            <!-- Project Visuals (Carousel with Dots & Counter) -->
            <div class="lg:w-1/2 order-1 lg:order-2">
                <div class="flex flex-col">
                    {% assign hasGallery = false %}
                    {% if page.gallery.size > 0 %}
                    {% assign hasGallery = true %}
                    {% endif %}

                    {% comment %} Check if project has Responsive tag {% endcomment %}
                    {% assign hasResponsiveTag = false %}
                    {% for tag in page.tags %}
                    {% if tag.name == "Responsive" %}
                    {% assign hasResponsiveTag = true %}
                    {% break %}
                    {% endif %}
                    {% endfor %}

                    <!-- Main Display (Carousel Viewport) -->
                    <div class="relative group w-full bg-black rounded-xl overflow-hidden flex flex-col justify-center shadow-2xl border border-white/10"
                        style="aspect-ratio: 4/3; max-height: 500px;" id="projectCarousel">

                        <!-- Counter (Top Right) -->
                        <div
                            class="absolute top-6 right-6 z-20 text-white font-mono font-bold text-sm tracking-wider bg-black/60 px-4 py-2 rounded-full backdrop-blur-md">
                            <span id="currentSlide">1</span> / <span id="totalSlides">0</span>
                        </div>

                        <!-- Slides Track -->
                        <div
                            class="carousel-track flex h-full transition-transform duration-500 ease-in-out w-full self-start">

                            <!-- Slide 0: Main Image -->
                            {% if page.image %}
                            <div class="min-w-full w-full flex-none h-full flex items-center justify-center p-0 lg:p-4 carousel-slide"
                                style="flex: 0 0 100% !important; min-width: 100% !important; width: 100% !important;">
                                <img src="{{ page.image }}" alt="{{ page.title }} - Main" class="h-full object-contain">
                            </div>
                            {% endif %}

                            <!-- Slides 1..N: Gallery -->
                            {% if hasGallery %}
                            {% for img in page.gallery %}
                            <div class="min-w-full w-full flex-none h-full flex items-center justify-center p-0 lg:p-4 carousel-slide"
                                style="flex: 0 0 100% !important; min-width: 100% !important; width: 100% !important;">
                                {% if img contains '.pdf' %}
                                <div
                                    class="h-full w-full flex items-center justify-center bg-gray-100 relative group-pdf">
                                    <iframe src="{{ img }}#toolbar=0&navpanes=0"
                                        class="h-full w-full object-contain border-0" type="application/pdf"></iframe>
                                </div>
                                {% else %}
                                <img src="{{ img }}" alt="{{ page.title }} - Gallery {{ forloop.index }}"
                                    class="h-full object-contain" loading="lazy">
                                {% endif %}
                            </div>
                            {% endfor %}
                            {% endif %}
                        </div>

                        <!-- Navigation Buttons -->
                        <button id="prevBtn"
                            class="absolute top-1/2 left-4 -translate-y-1/2 w-10 h-10 flex items-center justify-center bg-black/60 hover:bg-black/80 backdrop-blur-md text-white rounded-full shadow-lg transition-all duration-300 transform hover:scale-110 focus:outline-none z-30"
                            aria-label="Previous image">
                            <i class='bx bx-chevron-left text-3xl'></i>
                        </button>
                        <button id="nextBtn"
                            class="absolute top-1/2 right-4 -translate-y-1/2 w-10 h-10 flex items-center justify-center bg-black/60 hover:bg-black/80 backdrop-blur-md text-white rounded-full shadow-lg transition-all duration-300 transform hover:scale-110 focus:outline-none z-30"
                            aria-label="Next image">
                            <i class='bx bx-chevron-right text-3xl'></i>
                        </button>


                    </div>
                    <!-- Pagination Dots (Moved below) -->
                    <div class="flex justify-center mt-4 gap-3" id="carouselDots">
                        <!-- Dots generated by JS -->
                    </div>

                    {% if hasResponsiveTag %}
                    <!-- Responsive Filter Buttons -->
                    <div class="flex justify-center gap-2 mt-4" id="responsiveFilter">
                        <button
                            class="filter-btn active px-4 py-2 rounded-lg border-2 border-[#C1B4F8] dark:border-[#281E5A] bg-[#411FEB] dark:bg-[#5536ED] text-white font-semibold text-sm transition-all duration-200 hover:bg-[#3A1CC5] dark:hover:bg-[#4429C9]"
                            data-filter="all">
                            Toutes
                        </button>
                        <button
                            class="filter-btn px-4 py-2 rounded-lg border-2 border-[#C1B4F8] dark:border-[#281E5A] bg-transparent text-[#411FEB] dark:text-[#5536ED] font-semibold text-sm transition-all duration-200 hover:bg-[#E8E4FC] dark:hover:bg-[#5536ED]/10"
                            data-filter="desktop">
                            Desktop
                        </button>
                        <button
                            class="filter-btn px-4 py-2 rounded-lg border-2 border-[#C1B4F8] dark:border-[#281E5A] bg-transparent text-[#411FEB] dark:text-[#5536ED] font-semibold text-sm transition-all duration-200 hover:bg-[#E8E4FC] dark:hover:bg-[#5536ED]/10"
                            data-filter="mobile">
                            Mobile
                        </button>
                    </div>
                    {% endif %}
                </div>

            </div>
        </article>
    </main>

    {% include footer.html %}

    <script type="application/json" id="project-data">
    {
        "image": "{{ page.image }}",
        "gallery": [
            {% for img in page.gallery %}
                "{{ img }}"{% unless forloop.last %},{% endunless %}
            {% endfor %}
        ],
        "title": "{{ page.title | escape }}"
    }
    </script>
    <script src="/js/project-carousel.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const projectData = JSON.parse(document.getElementById('project-data').textContent);
            const images = [];

            // Only add main image if it is in the results folder
            if (projectData.image && projectData.image.includes("/results/")) {
                images.push(projectData.image);
            }

            // Add gallery images
            if (projectData.gallery && projectData.gallery.length > 0) {
                images.push(...projectData.gallery);
            }

            ProjectCarousel.init({
                images: images,
                projectTitle: projectData.title,
                containerId: "projectCarousel",
                trackSelector: ".carousel-track",
                prevBtnId: "prevBtn",
                nextBtnId: "nextBtn",
                dotsId: "carouselDots",
                currentSlideId: "currentSlide",
                totalSlidesId: "totalSlides"
            });
        });
    </script>
</body>

</html>