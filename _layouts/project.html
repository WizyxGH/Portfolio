<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} - Florian Gertner Kilian</title>

    <!-- SEO & Open Graph -->

    <!-- SEO & Open Graph -->
    {% seo %}
    {% if page.image %}
    <meta property="og:image:alt" content="{{ page.title | escape }}">
    {% if page.width %}
    <meta property="og:image:width" content="{{ page.width }}">{% endif %}
    {% if page.height %}
    <meta property="og:image:height" content="{{ page.height }}">{% endif %}
    {% endif %}

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Inter&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ '/assets/css/boxicons.min.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/tailwind.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/styles.css' | relative_url }}">
    <link rel="icon" type="image/x-icon" href="{{ '/assets/media/favicon.ico' | relative_url }}">

    <link rel="canonical" href="{{ site.url }}{{ page.url }}">

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "CreativeWork",
      "headline": "{{ page.title | escape }}",
      "image": [
        "{{ site.url }}{{ page.image }}"
        {% for img in page.gallery %},"{{ site.url }}{{ img }}"{% endfor %}
      ],
      "datePublished": "{{ page.date | date_to_xmlschema }}",
      "author": [{
          "@type": "Person",
          "name": "Florian Gertner Kilian",
          "url": "https://wizyx.me"
        }]
    }
    </script>

    <!-- Breadcrumb JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Accueil",
        "item": "{{ site.url }}"
      },{
        "@type": "ListItem",
        "position": 2,
        "name": "Créations",
        "item": "{{ site.url }}/creations"
      },{
        "@type": "ListItem",
        "position": 3,
        "name": "{{ page.title | escape }}",
        "item": "{{ site.url }}{{ page.url }}"
      }]
    }
    </script>

    <script src="/js/layout.js" defer></script>
    <script src="/js/theme.js" defer></script>
</head>

<body class="dark:bg-[#121212] font-inter text-[#411FEB]">

    <!-- Navbar -->
    {% include navbar.html %}

    <main class="px-6 lg:px-32 mx-auto p-8 space-y-4">
        <div>
            <div class="flex flex-col items-start lg:flex-row lg:items-center">
                <a href="/creations"
                    class="inline-flex items-center justify-center text-[#121212] dark:text-white hover:text-[#411FEB] dark:hover:text-[#5536ED] transition-colors p-2 -ml-2 rounded-full hover:bg-black/5 dark:hover:bg-white/5 leading-none"
                    aria-label="Retour aux créations">
                    <i class='bx bx-arrow-back text-2xl lg:text-3xl leading-none'></i>
                </a>
                <h1 class="text-2xl lg:text-4xl font-bold text-[#411FEB] dark:text-[#5536ED] leading-tight">{{
                    page.title }}</h1>
            </div>

            <div class="flex flex-col gap-2 mb-8">
                <div class="flex flex-wrap items-center gap-2 text-sm text-[#121212] dark:text-white">
                    <div class="flex items-center gap-1">
                        <i class="bx bxs-calendar-alt text-[#411FEB] dark:text-[#5536ED] opacity-[0.48] text-base"></i>
                        {% assign months =
                        "janvier,février,mars,avril,mai,juin,juillet,août,septembre,octobre,novembre,décembre" | split:
                        "," %}
                        {% assign m = page.date | date: "%-m" | minus: 1 %}
                        <time datetime="{{ page.date | date_to_xmlschema }}">{{ months[m] }} {{ page.date | date: "%Y"
                            }}</time>
                    </div>

                    {% if page.type %}
                    <span class="text-[#411FEB] dark:text-[#5536ED] opacity-[0.48]">&middot;</span>
                    <span>{{ page.type }}</span>
                    {% endif %}

                    {% if page.context %}
                    <span class="text-[#411FEB] dark:text-[#5536ED] opacity-[0.48]">&middot;</span>
                    <span>{{ page.context }}</span>
                    {% endif %}
                </div>

                <div class="flex flex-wrap gap-2">
                    {% for tag in page.tags %}
                    <span
                        class="inline-flex items-center gap-1 px-2 rounded-full border border-[#411FEB] text-[#411FEB] font-semibold text-sm dark:text-[#5536ED] dark:border-[#5536ED]"
                        style="background-color: rgba(65, 31, 235, 0.12)">
                        <i class='{{ tag.icon }} text-base'></i> {{ tag.name }}
                    </span>
                    {% endfor %}
                </div>
            </div>
        </div>

        <article class="flex flex-col lg:flex-row gap-8">
            <!-- Project Content -->
            <div class="lg:w-1/2 space-y-4 order-2 lg:order-1">
                <div class="prose dark:prose-invert max-w-none text-[#121212] dark:text-white leading-relaxed">
                    {{ content }}
                </div>

                {% if page.projectLink and page.projectLink != "#" %}
                <a href="{{ page.projectLink }}" target="_blank"
                    class="flex items-center justify-center gap-2 bg-[#411FEB] text-white font-semibold px-6 py-3 rounded-lg hover:bg-[#3A1CC5] transition w-full lg:w-auto lg:self-start">
                    {% if page.type == 'Application' %}
                    <i class="bx bx-globe"></i> Voir l'application
                    {% else %}
                    <i class="bx bx-globe"></i> Visiter le site web
                    {% endif %}
                </a>
                {% endif %}

                <a href="/services/"
                    class="group flex items-center gap-3 mt-6 border-t border-gray-200 dark:border-gray-800 pt-4 hover:bg-gray-50 dark:hover:bg-white/5 -mx-4 px-4 py-2 rounded-xl transition-colors cursor-pointer">
                    <img src="/assets/media/profilepicturepro.png" alt="Florian Gertner Kilian"
                        class="w-12 h-12 rounded-full object-cover border-2 border-transparent group-hover:border-[#411FEB] transition-colors">
                    <div>
                        <p
                            class="text-sm font-semibold text-[#121212] dark:text-white group-hover:text-[#411FEB] transition-colors">
                            Designé par Florian Gertner Kilian</p>
                        <p
                            class="text-xs text-gray-500 dark:text-gray-400 group-hover:text-[#411FEB] transition-colors">
                            Besoin d'un design pour votre projet ? <span
                                class="underline decoration-[#411FEB]/30 group-hover:decoration-[#411FEB]">Voir mes
                                services</span></p>
                    </div>
                </a>
            </div>

            <!-- Project Visuals (Carousel with Dots & Counter) -->
            <div class="lg:w-1/2 order-1 lg:order-2">
                <div class="flex flex-col">
                    {% assign hasGallery = false %}
                    {% if page.gallery.size > 0 %}
                    {% assign hasGallery = true %}
                    {% endif %}

                    <!-- Main Display (Carousel Viewport) -->
                    <div class="relative group w-full bg-black rounded-xl overflow-hidden flex flex-col justify-center shadow-2xl border border-white/10"
                        style="aspect-ratio: 4/3; max-height: 500px;" id="projectCarousel">

                        <!-- Counter (Top Right) -->
                        <div
                            class="absolute top-6 right-6 z-20 text-white font-mono font-bold text-sm tracking-wider bg-black/60 px-4 py-2 rounded-full backdrop-blur-md">
                            <span id="currentSlide">1</span> / <span id="totalSlides">0</span>
                        </div>

                        <!-- Slides Track -->
                        <div
                            class="carousel-track flex h-full transition-transform duration-500 ease-in-out w-full self-start">

                            <!-- Slide 0: Main Image -->
                            {% if page.image %}
                            <div class="min-w-full w-full flex-none h-full flex items-center justify-center p-0 lg:p-4 carousel-slide"
                                style="flex: 0 0 100% !important; min-width: 100% !important; width: 100% !important;">
                                <img src="{{ page.image }}" alt="{{ page.title }} - Main" class="h-full object-contain">
                            </div>
                            {% endif %}

                            <!-- Slides 1..N: Gallery -->
                            {% if hasGallery %}
                            {% for img in page.gallery %}
                            <div class="min-w-full w-full flex-none h-full flex items-center justify-center p-0 lg:p-4 carousel-slide"
                                style="flex: 0 0 100% !important; min-width: 100% !important; width: 100% !important;">
                                {% if img contains '.pdf' %}
                                <div
                                    class="h-full w-full flex items-center justify-center bg-gray-100 relative group-pdf">
                                    <iframe src="{{ img }}#toolbar=0&navpanes=0"
                                        class="h-full w-full object-contain border-0" type="application/pdf"></iframe>
                                </div>
                                {% else %}
                                <img src="{{ img }}" alt="{{ page.title }} - Gallery {{ forloop.index }}"
                                    class="h-full object-contain" loading="lazy">
                                {% endif %}
                            </div>
                            {% endfor %}
                            {% endif %}
                        </div>

                        <!-- Navigation Buttons -->
                        <button id="prevBtn"
                            class="absolute top-1/2 left-4 -translate-y-1/2 w-12 h-12 flex items-center justify-center bg-white text-black rounded-full shadow-lg transition-all duration-300 transform hover:scale-110 focus:outline-none z-30"
                            aria-label="Previous image">
                            <i class='bx bx-chevron-left text-3xl'></i>
                        </button>
                        <button id="nextBtn"
                            class="absolute top-1/2 right-4 -translate-y-1/2 w-12 h-12 flex items-center justify-center bg-white text-black rounded-full shadow-lg transition-all duration-300 transform hover:scale-110 focus:outline-none z-30"
                            aria-label="Next image">
                            <i class='bx bx-chevron-right text-3xl'></i>
                        </button>


                    </div>
                    <!-- Pagination Dots (Moved below) -->
                    <div class="flex justify-center mt-4 gap-3" id="carouselDots">
                        <!-- Dots generated by JS -->
                    </div>
                </div>

            </div>
        </article>
    </main>

    {% include footer.html %}

    <script type="application/json" id="project-data">
    {
        "image": "{{ page.image }}",
        "gallery": [
            {% for img in page.gallery %}
                "{{ img }}"{% unless forloop.last %},{% endunless %}
            {% endfor %}
        ],
        "title": "{{ page.title | escape }}"
    }
    </script>
    <script src="/js/project-carousel.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const projectData = JSON.parse(document.getElementById('project-data').textContent);
            const images = [];

            // Only add main image if it is in the results folder
            if (projectData.image && projectData.image.includes("/results/")) {
                images.push(projectData.image);
            }

            // Add gallery images
            if (projectData.gallery && projectData.gallery.length > 0) {
                images.push(...projectData.gallery);
            }

            ProjectCarousel.init({
                images: images,
                projectTitle: projectData.title,
                containerId: "projectCarousel",
                trackSelector: ".carousel-track",
                prevBtnId: "prevBtn",
                nextBtnId: "nextBtn",
                dotsId: "carouselDots",
                currentSlideId: "currentSlide",
                totalSlidesId: "totalSlides"
            });
        });
    </script>
</body>

</html>